<!DOCTYPE html>

<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Staff Roster System v8.0 - Final Fixed</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.29/jspdf.plugin.autotable.min.js"></script>

```
<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
    import { getFirestore, collection, getDocs, doc, setDoc, addDoc, deleteDoc, onSnapshot, query } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
    
    const firebaseConfig = {
        apiKey: "AIzaSyAP7b4KcwRYPMZjNc2TWsNqMvC3ywImhOM",
        authDomain: "roster-4a997.firebaseapp.com",
        projectId: "roster-4a997",
        storageBucket: "roster-4a997.firebasestorage.app",
        messagingSenderId: "901381868881",
        appId: "1:901381868881:web:92930481d6c1c85fedd770"
    };

    try {
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        window.db = db;
        window.firebase = { collection, getDocs, doc, setDoc, addDoc, deleteDoc, onSnapshot, query };
        window.firebaseReady = true;
        console.log("‚úÖ Firebase ready");
    } catch (error) {
        console.error("‚ùå Firebase error:", error);
        window.firebaseError = error;
    }
</script>

<style>
    body { font-family: system-ui, sans-serif; background: #f1f5f9; }
    .card { background: white; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
    .btn { transition: all 0.2s; }
    .btn:hover:not(:disabled) { transform: translateY(-1px); }
    .styled-table { border-collapse: collapse; width: 100%; }
    .styled-table th, .styled-table td { border: 1px solid #e2e8f0; padding: 6px; text-align: center; }
    .styled-table th { background: #f1f5f9; font-weight: 600; }
    .conflict-cell { background: #fef2f2 !important; border-color: #ef4444 !important; }
    .break-conflict { background: #fef3c7 !important; border-color: #f59e0b !important; }
    .modal { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.5); align-items: center; justify-content: center; z-index: 50; }
</style>
```

</head>
<body>
    <div class="max-w-6xl mx-auto p-4">
        <header class="text-center mb-8">
            <h1 class="text-3xl font-bold text-purple-600 mb-2">Staff Roster System</h1>
            <p class="text-gray-600">v8.0 - Conflict-Free Edition</p>
            <div id="status" class="mt-4 p-3 rounded bg-blue-100 text-blue-800">üîÑ Connecting...</div>
        </header>

```
    <div class="card p-6 mb-6">
        <div class="grid md:grid-cols-3 gap-4">
            <div>
                <label class="block font-medium mb-2">Date:</label>
                <input type="date" id="rosterDate" class="w-full p-2 border rounded">
            </div>
            <div>
                <label class="block font-medium mb-2">Day:</label>
                <select id="rosterDay" class="w-full p-2 border rounded">
                    <option>Monday</option><option>Tuesday</option><option>Wednesday</option>
                    <option>Thursday</option><option>Friday</option><option>Saturday</option><option>Sunday</option>
                </select>
            </div>
            <div class="text-center">
                <label class="block font-medium mb-2">Working Staff:</label>
                <span id="staffCount" class="text-3xl font-bold text-blue-600">0</span>
            </div>
        </div>
    </div>

    <div class="card p-6 mb-6">
        <h2 class="text-xl font-bold mb-4">Staff Management</h2>
        <div class="overflow-x-auto">
            <table id="staffTable" class="styled-table">
                <thead>
                    <tr><th>ID</th><th>Name</th><th>Break Start</th><th>Break End</th><th>HHMD</th><th>Present</th><th>Actions</th></tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
        <div class="mt-4 flex gap-3 justify-center">
            <button id="addBtn" class="btn bg-blue-600 text-white px-4 py-2 rounded" disabled>Add Staff</button>
            <button id="shuffleBtn" class="btn bg-purple-600 text-white px-4 py-2 rounded" disabled>Shuffle Breaks</button>
        </div>
    </div>

    <div class="card p-6">
        <h2 class="text-xl font-bold text-center mb-4">Generate Roster</h2>
        <div class="text-center mb-4">
            <button id="generateBtn" class="btn bg-green-600 text-white px-8 py-3 rounded-lg text-lg" disabled>Generate</button>
        </div>
        <div id="messages"></div>
        <div id="rosterWrapper" class="mt-6 opacity-0 transition-opacity">
            <div id="rosterTable"></div>
            <div id="actions" class="mt-4 flex gap-3 justify-center" style="display:none">
                <button id="copyBtn" class="btn bg-blue-600 text-white px-4 py-2 rounded">Copy</button>
                <button id="pdfBtn" class="btn bg-red-600 text-white px-4 py-2 rounded">PDF</button>
            </div>
        </div>
    </div>
</div>

<div id="pdfModal" class="modal">
    <div class="bg-white p-6 rounded-lg max-w-4xl w-full mx-4">
        <div class="flex justify-between items-center mb-4">
            <h3 class="text-xl font-bold">PDF Preview</h3>
            <button id="closeModal" class="text-2xl">&times;</button>
        </div>
        <iframe id="pdfFrame" class="w-full h-96 border"></iframe>
        <div class="mt-4 text-center">
            <a id="downloadLink" href="#" download="roster.pdf" class="btn bg-blue-600 text-white px-6 py-2 rounded">Download</a>
        </div>
    </div>
</div>
```

<script>
const roster = {
    TIMES: ["20:00", "21:00", "22:00", "23:00", "00:00", "01:00", "02:00", "03:00", "04:00", "05:00", "06:00", "07:00"],
    LOCATIONS: [
        { name: "Pass Counter", slots: 2 },
        { name: "HHMD", slots: 1 },
        { name: "Guard House", slots: 1 },
        { name: "Lobby", slots: 2 },
        { name: "Report Room", slots: 1 },
        { name: "Vertical Patrol", slots: 1 },
        { name: "Tango Papa", slots: 1 }
    ],
    CRITICAL: {
        "Vertical Patrol": ["20:00", "23:00", "01:00", "04:00", "06:00"],
        "Report Room": ["20:00", "21:00"],
        "Tango Papa": ["07:00"]
    },
    
    staff: [],
    schedule: null,
    db: null,
    firebase: null,

    async init() {
        try {
            await this.waitForFirebase();
            this.setupUI();
            this.setupListeners();
            this.listenToStaff();
            this.updateStatus("‚úÖ Ready", "bg-green-100 text-green-800");
            this.enableButtons();
        } catch (error) {
            console.error("Init error:", error);
            this.updateStatus("‚ùå Connection failed", "bg-red-100 text-red-800");
        }
    },

    waitForFirebase() {
        return new Promise((resolve, reject) => {
            const check = () => {
                if (window.firebaseReady && window.db) {
                    this.db = window.db;
                    this.firebase = window.firebase;
                    resolve();
                } else if (window.firebaseError) {
                    reject(window.firebaseError);
                } else {
                    setTimeout(check, 100);
                }
            };
            check();
        });
    },

    updateStatus(text, classes) {
        const el = document.getElementById('status');
        el.textContent = text;
        el.className = `mt-4 p-3 rounded ${classes}`;
    },

    setupUI() {
        const today = new Date();
        document.getElementById('rosterDate').value = today.toISOString().split('T')[0];
        document.getElementById('rosterDay').value = today.toLocaleDateString('en-US', { weekday: 'long' });
    },

    enableButtons() {
        ['addBtn', 'shuffleBtn', 'generateBtn'].forEach(id => {
            document.getElementById(id).disabled = false;
        });
    },

    setupListeners() {
        document.getElementById('addBtn').onclick = () => this.addStaff();
        document.getElementById('shuffleBtn').onclick = () => this.shuffle();
        document.getElementById('generateBtn').onclick = () => this.generate();
        document.getElementById('copyBtn').onclick = () => this.copy();
        document.getElementById('pdfBtn').onclick = () => this.makePDF();
        document.getElementById('closeModal').onclick = () => this.closeModal();
    },

    listenToStaff() {
        const { collection, onSnapshot } = this.firebase;
        onSnapshot(collection(this.db, "staff"), (snap) => {
            this.staff = snap.docs.map(doc => ({ id: doc.id, ...doc.data() }))
                .sort((a, b) => (a.staffId || "").localeCompare(b.staffId || ""));
            this.renderStaff();
            this.updateCount();
        });
    },

    updateCount() {
        // Check multiple possible field names for attendance
        const count = this.staff.filter(s => 
            s.present === 'Yes' || s.attendance === 'Yes' || (!s.present && !s.attendance)
        ).length;
        document.getElementById('staffCount').textContent = count;
    },

    renderStaff() {
        const tbody = document.querySelector('#staffTable tbody');
        if (this.staff.length === 0) {
            tbody.innerHTML = '<tr><td colspan="7" class="text-center py-4 text-gray-500">No staff found</td></tr>';
            return;
        }

        tbody.innerHTML = this.staff.map(s => `
            <tr data-id="${s.id}">
                <td><input data-field="staffId" value="${s.staffId || s.id || ''}" class="w-20 p-1 border rounded text-center"></td>
                <td><input data-field="name" value="${s.name || ''}" class="w-24 p-1 border rounded"></td>
                <td><input type="time" data-field="breakStart" value="${s.breakStart || '22:00'}" class="p-1 border rounded"></td>
                <td><input type="time" data-field="breakEnd" value="${s.breakEnd || '00:00'}" class="p-1 border rounded"></td>
                <td>
                    <select data-field="hhmd" class="p-1 border rounded">
                        <option value="Yes" ${(s.hhmd === 'Yes' || s.hhmd === true) ? 'selected' : ''}>Yes</option>
                        <option value="No" ${(s.hhmd !== 'Yes' && s.hhmd !== true) ? 'selected' : ''}>No</option>
                    </select>
                </td>
                <td>
                    <select data-field="present" class="p-1 border rounded">
                        <option value="Yes" ${(s.present !== 'No' && s.attendance !== 'No') ? 'selected' : ''}>Yes</option>
                        <option value="No" ${(s.present === 'No' || s.attendance === 'No') ? 'selected' : ''}>No</option>
                    </select>
                </td>
                <td><button class="remove-btn text-red-600 hover:text-red-800 px-2 py-1 rounded">Remove</button></td>
            </tr>
        `).join('');

        tbody.querySelectorAll('tr').forEach(row => {
            row.querySelectorAll('input, select').forEach(input => {
                input.onchange = (e) => this.updateStaff(e);
            });
            row.querySelector('.remove-btn').onclick = (e) => this.removeStaff(e);
        });
    },

    async addStaff() {
        try {
            await this.firebase.addDoc(this.firebase.collection(this.db, "staff"), {
                staffId: `S${Date.now().toString().slice(-4)}`,
                name: "New Staff",
                breakStart: "22:00",
                breakEnd: "00:00",
                hhmd: "No",
                present: "Yes",
                created: new Date()
            });
            this.showMessage("Staff added", "success");
        } catch (error) {
            this.showMessage("Error adding staff", "error");
        }
    },

    async updateStaff(event) {
        const row = event.target.closest('tr');
        const id = row.dataset.id;
        const data = {};
        row.querySelectorAll('[data-field]').forEach(input => {
            data[input.dataset.field] = input.value;
        });

        try {
            await this.firebase.setDoc(this.firebase.doc(this.db, "staff", id), data, { merge: true });
        } catch (error) {
            this.showMessage("Error updating staff", "error");
        }
    },

    async removeStaff(event) {
        const row = event.target.closest('tr');
        const id = row.dataset.id;
        const name = row.querySelector('[data-field="staffId"]').value || "staff";

        if (confirm(`Remove ${name}?`)) {
            try {
                await this.firebase.deleteDoc(this.firebase.doc(this.db, "staff", id));
                this.showMessage("Staff removed", "success");
            } catch (error) {
                this.showMessage("Error removing staff", "error");
            }
        }
    },

    async shuffle() {
        const present = this.staff.filter(s => s.present === 'Yes');
        if (present.length < 2) {
            this.showMessage("Need at least 2 staff to shuffle", "warning");
            return;
        }

        const breaks = present.map(s => ({ start: s.breakStart, end: s.breakEnd }));
        for (let i = breaks.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [breaks[i], breaks[j]] = [breaks[j], breaks[i]];
        }

        try {
            await Promise.all(present.map((staff, i) =>
                this.firebase.setDoc(this.firebase.doc(this.db, "staff", staff.id), {
                    breakStart: breaks[i].start,
                    breakEnd: breaks[i].end
                }, { merge: true })
            ));
            this.showMessage("Breaks shuffled", "success");
        } catch (error) {
            this.showMessage("Error shuffling", "error");
        }
    },

    toMinutes(time) {
        if (!time) return -1;
        let [h, m] = time.split(':').map(Number);
        if (h < 8) h += 24;
        return h * 60 + m;
    },

    onBreak(staff, time) {
        const start = this.toMinutes(staff.breakStart);
        const end = this.toMinutes(staff.breakEnd);
        const slot = this.toMinutes(time);
        if (start === -1 || end === -1 || slot === -1) return false;
        return start > end ? (slot >= start || slot < end) : (slot >= start && slot < end);
    },

    hasConflict(schedule, staffIdentifier, time, location, pos) {
        // Find staff by multiple possible identifiers
        const staff = this.staff.find(s => 
            s.staffId === staffIdentifier || s.id === staffIdentifier || s.name === staffIdentifier
        );
        if (!staff) return null;

        if (this.onBreak(staff, time)) {
            return { type: 'break', msg: `${staffIdentifier} on break at ${time}` };
        }

        if (location === 'HHMD' && staff.hhmd !== 'Yes' && staff.hhmd !== true) {
            return { type: 'qual', msg: `${staffIdentifier} not HHMD qualified` };
        }

        // Check double assignment
        for (const loc of this.LOCATIONS.map(l => l.name)) {
            if (schedule[loc] && schedule[loc][time]) {
                for (let i = 0; i < schedule[loc][time].length; i++) {
                    if (schedule[loc][time][i] === staffIdentifier && !(loc === location && i === pos)) {
                        return { type: 'double', msg: `${staffIdentifier} already at ${loc}` };
                    }
                }
            }
        }
        return null;
    },

    generate() {
        // Check multiple field names for attendance
        const present = this.staff.filter(s => 
            s.present === 'Yes' || s.attendance === 'Yes' || (!s.present && !s.attendance)
        );
        if (present.length === 0) {
            this.showMessage("No staff present", "error");
            return;
        }

        const schedule = {};
        this.LOCATIONS.forEach(loc => {
            schedule[loc.name] = {};
            this.TIMES.forEach(time => {
                schedule[loc.name][time] = new Array(loc.slots).fill('');
            });
        });

        const isWeekend = ['Saturday', 'Sunday'].includes(document.getElementById('rosterDay').value);
        const issues = [];

        const assign = (time, location, slot) => {
            const shuffled = [...present].sort(() => Math.random() - 0.5);
            for (const staff of shuffled) {
                // Use staffId if available, otherwise use document id
                const staffIdentifier = staff.staffId || staff.id || staff.name;
                const conflict = this.hasConflict(schedule, staffIdentifier, time, location, slot);
                if (!conflict) {
                    schedule[location][time][slot] = staffIdentifier;
                    return true;
                }
            }
            issues.push(`${location} at ${time}`);
            return false;
        };

        // Critical duties first
        for (const [loc, times] of Object.entries(this.CRITICAL)) {
            if (isWeekend && loc === "Report Room") continue;
            const slots = this.LOCATIONS.find(l => l.name === loc).slots;
            times.forEach(time => {
                for (let i = 0; i < slots; i++) {
                    assign(time, loc, i);
                }
            });
        }

        // Fill remaining
        this.LOCATIONS.forEach(({ name, slots }) => {
            this.TIMES.forEach(time => {
                for (let i = 0; i < slots; i++) {
                    if (schedule[name][time][i] === '') {
                        assign(time, name, i);
                    }
                }
            });
        });

        this.schedule = schedule;
        this.displaySchedule();
        
        if (issues.length > 0) {
            issues.forEach(issue => this.showMessage(`Shortfall: ${issue}`, "warning"));
        } else {
            this.showMessage("‚úÖ Generated successfully!", "success");
        }

        this.saveSchedule();
        document.getElementById('actions').style.display = 'flex';
        document.getElementById('rosterWrapper').classList.remove('opacity-0');
    },

    displaySchedule() {
        const staffOpts = '<option value="">--</option>' + 
            present.map(s => {
                const identifier = s.staffId || s.id || s.name;
                return `<option value="${identifier}">${identifier}</option>`;
            }).join('');

        const isWeekend = ['Saturday', 'Sunday'].includes(document.getElementById('rosterDay').value);

        let html = `<table class="styled-table"><thead><tr><th class="text-left">Location</th>`;
        this.TIMES.forEach(time => html += `<th>${time}</th>`);
        html += '</tr></thead><tbody>';

        this.LOCATIONS.filter(l => l.name !== "Tango Papa").forEach(({ name, slots }) => {
            const isCombined = name === "Vertical Patrol";
            html += `<tr><td class="font-medium text-left bg-gray-50">
                ${isCombined ? 'Vertical Patrol<br><small>Tango Papa</small>' : name}
            </td>`;

            this.TIMES.forEach(time => {
                let content = '';
                let applicable = true;

                if (this.CRITICAL[name] && !this.CRITICAL[name].includes(time)) applicable = false;
                if (name === "Report Room" && isWeekend) applicable = false;

                if (isCombined) {
                    const vpActive = this.CRITICAL['Vertical Patrol'].includes(time);
                    const tpActive = this.CRITICAL['Tango Papa'].includes(time);
                    
                    if (vpActive || tpActive) {
                        if (vpActive) {
                            const sel = this.schedule['Vertical Patrol'][time][0] || '';
                            content += `<select data-loc="Vertical Patrol" data-time="${time}" data-slot="0" class="roster-sel w-full mb-1 text-xs">
                                ${staffOpts.replace(`value="${sel}"`, `value="${sel}" selected`)}</select>`;
                        }
                        if (tpActive) {
                            const sel = this.schedule['Tango Papa'][time][0] || '';
                            content += `<select data-loc="Tango Papa" data-time="${time}" data-slot="0" class="roster-sel w-full text-xs">
                                ${staffOpts.replace(`value="${sel}"`, `value="${sel}" selected`)}</select>`;
                        }
                    } else applicable = false;
                } else if (applicable) {
                    for (let i = 0; i < slots; i++) {
                        const sel = this.schedule[name][time][i] || '';
                        content += `<select data-loc="${name}" data-time="${time}" data-slot="${i}" class="roster-sel w-full text-xs ${i ? 'mt-1' : ''}">
                            ${staffOpts.replace(`value="${sel}"`, `value="${sel}" selected`)}</select>`;
                    }
                }

                html += `<td class="${applicable ? '' : 'bg-gray-100'} p-1">${content}</td>`;
            });
            html += '</tr>';
        });

        html += '</tbody></table>';
        document.getElementById('rosterTable').innerHTML = html;

        document.querySelectorAll('.roster-sel').forEach(sel => {
            sel.onchange = (e) => this.changeAssignment(e);
        });

        this.validateSchedule();
    },

    changeAssignment(event) {
        const { loc, time, slot } = event.target.dataset;
        const newStaff = event.target.value;
        const oldStaff = this.schedule[loc][time][parseInt(slot)];

        if (newStaff) {
            const conflict = this.hasConflict(this.schedule, newStaff, time, loc, parseInt(slot));
            if (conflict) {
                this.showMessage(conflict.msg, "error");
                event.target.value = oldStaff;
                return;
            }
        }

        this.schedule[loc][time][parseInt(slot)] = newStaff;
        this.validateSchedule();
        this.saveSchedule();
    },

    validateSchedule() {
        document.querySelectorAll('.conflict-cell, .break-conflict').forEach(el => {
            el.classList.remove('conflict-cell', 'break-conflict');
        });

        this.TIMES.forEach(time => {
            const assignments = {};
            
            this.LOCATIONS.forEach(({ name }) => {
                if (this.schedule[name] && this.schedule[name][time]) {
                    this.schedule[name][time].forEach((staffId, slot) => {
                        if (staffId) {
                            if (!assignments[staffId]) assignments[staffId] = [];
                            assignments[staffId].push({ name, slot });
                        }
                    });
                }
            });

            Object.keys(assignments).forEach(staffIdentifier => {
                // Find staff by identifier
                const staff = this.staff.find(s => 
                    s.staffId === staffIdentifier || s.id === staffIdentifier || s.name === staffIdentifier
                );
                const isOnBreak = staff && this.onBreak(staff, time);
                const hasMultiple = assignments[staffIdentifier].length > 1;

                assignments[staffIdentifier].forEach(({ name, slot }) => {
                    const sel = document.querySelector(`select[data-loc="${name}"][data-time="${time}"][data-slot="${slot}"]`);
                    if (sel) {
                        const cell = sel.closest('td');
                        if (isOnBreak) cell.classList.add('break-conflict');
                        if (hasMultiple) cell.classList.add('conflict-cell');
                    }
                });
            });
        });
    },

    async saveSchedule() {
        if (!this.schedule) return;
        const date = document.getElementById('rosterDate').value;
        try {
            await this.firebase.setDoc(this.firebase.doc(this.db, "rosters", date), {
                date,
                day: document.getElementById('rosterDay').value,
                schedule: this.schedule,
                updated: new Date()
            });
        } catch (error) {
            console.error("Save error:", error);
        }
    },

    copy() {
        if (!this.schedule) return;
        const rows = this.LOCATIONS.map(({ name }) => 
            `${name}\t${this.TIMES.map(time => 
                (this.schedule[name]?.[time] || []).filter(Boolean).join(' | ')
            ).join('\t')}`
        );
        navigator.clipboard.writeText(`Location\t${this.TIMES.join('\t')}\n${rows.join('\n')}`)
            .then(() => this.showMessage("Copied!", "success"))
            .catch(() => this.showMessage("Copy failed", "error"));
    },

    makePDF() {
        if (!this.schedule) return;
        try {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF({ orientation: "landscape" });
            const date = document.getElementById('rosterDate').value;
            const day = document.getElementById('rosterDay').value;

            doc.setFontSize(16);
            doc.text(`Staff Roster - ${date} (${day})`, 14, 15);

            const body = this.LOCATIONS.filter(l => l.name !== 'Tango Papa').map(({ name }) => {
                const display = name === 'Vertical Patrol' ? 'Vertical Patrol\nTango Papa' : name;
                const data = this.TIMES.map(time => {
                    if (name === 'Vertical Patrol') {
                        const vp = (this.schedule['Vertical Patrol'][time] || []).filter(Boolean).join(', ');
                        const tp = (this.schedule['Tango Papa'][time] || []).filter(Boolean).join(', ');
                        return `${vp}${vp && tp ? '\n' : ''}${tp}`;
                    }
                    return (this.schedule[name][time] || []).filter(Boolean).join(' | ');
                });
                return [display, ...data];
            });

            doc.autoTable({
                head: [['Location', ...this.TIMES]],
                body,
                startY: 22,
                theme: 'grid',
                styles: { fontSize: 6, cellPadding: 1 },
                headStyles: { fillColor: [45, 55, 72] }
            });

            const staffBody = this.staff.filter(s => 
                s.present === 'Yes' || s.attendance === 'Yes' || (!s.present && !s.attendance)
            ).map(s => [
                s.staffId || s.id || s.name, 
                s.name, 
                `${s.breakStart} - ${s.breakEnd}`
            ]);

            doc.autoTable({
                head: [['Staff ID', 'Name', 'Break Time']],
                body: staffBody,
                startY: doc.autoTable.previous.finalY + 8,
                theme: 'striped',
                styles: { fontSize: 8 }
            });

            const url = doc.output('bloburl');
            document.getElementById('downloadLink').href = url;
            document.getElementById('pdfFrame').src = url;
            document.getElementById('pdfModal').style.display = 'flex';
        } catch (error) {
            this.showMessage("PDF error", "error");
        }
    },

    closeModal() {
        document.getElementById('pdfModal').style.display = 'none';
    },

    showMessage(text, type) {
        const colors = { success: 'green', error: 'red', warning: 'yellow', info: 'blue' };
        const div = document.createElement('div');
        div.className = `p-3 rounded mb-2 bg-${colors[type]}-100 text-${colors[type]}-800 border border-${colors[type]}-200`;
        div.textContent = text;
        document.getElementById('messages').appendChild(div);
        setTimeout(() => div.remove(), 5000);
    }
};

// Start when page loads
document.addEventListener('DOMContentLoaded', () => roster.init());
</script>

</body>
</html>